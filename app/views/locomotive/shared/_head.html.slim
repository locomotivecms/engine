- if current_site
  title== escape_once("#{Locomotive.config.name} &mdash; #{current_site.name}")
- else
  title= escape_once(Locomotive.config.name)

= csrf_meta_tag

- key = Rails.application.config.session_options[:key]

meta name='key-param' content=Rails.application.config.session_options[:key]
meta name='key-token' content=cookies[key]
meta name='unsaved-content-warning' content=t('locomotive.messages.unsaved_content_warning')
meta name="viewport" content="width=device-width, initial-scale=1"
meta name="backbone-view" content=backbone_view_class_name

link rel="icon" type="image/png" href="#{asset_url('locomotive/favicon.png')}" sizes="32x32"

javascript:
  window.locale         = '#{locale}';
  window.content_locale = '#{current_content_locale}';
  window.mounted_on     = '#{Locomotive.mounted_on}';
  window.flash_messages = #{{flash_messages_to_json}};

link href="https://fonts.googleapis.com/css?family=Muli:400,300|Noto+Sans:400,700" rel="stylesheet" type="text/css"

= stylesheet_link_tag     'locomotive/application', media: 'screen'
= javascript_include_tag  'locomotive'

/ = render 'locomotive/shared/main_app_head_before_backbone'

/ javascript:
/   window.locale                     = '#{locale}';
/   window.content_locale             = '#{current_content_locale}';

/   document.addEventListener("turbolinks:load", function() {
/     console.log('[turbolinks:load] fired');

/     window.application_view = new Locomotive.Views.ApplicationView({
/       flash:      #{{flash_messages_to_json}},
/       view:       #{backbone_view_class_name}
/     });
/     window.application_view.render();
/   });

/   document.addEventListener("turbolinks:before-visit", function() {
/     console.log('[turbolinks:before-visit] fired')
/     window.application_view.view.remove();
/   });

/   $(document).ready(function() {
/     /*console.log('building backbone view')

/     window.application_view = new Locomotive.Views.ApplicationView({
/       flash:      #{{flash_messages_to_json}},
/       view:       #{backbone_view_class_name}
/     });
/     window.application_view.render();
/     */
/   });

= yield :head

= render 'locomotive/shared/main_app_head'
